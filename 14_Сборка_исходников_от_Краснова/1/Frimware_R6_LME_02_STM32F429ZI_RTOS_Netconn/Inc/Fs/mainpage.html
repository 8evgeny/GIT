<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv='Content-Type' content='text/html; charset=windows-1251'>
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<title>GIT Настройка R LME</title>

<style type="text/css">
.eb_RO {
	background-color: #F7F7F7;
	text-align: center;
	width: 150px;
}
.eb_RW {
	background-color:#FFFBF0;
	text-align: center;
	width: 150px;
}
.lb_RW {
	background-color:#FFFBF0;
	text-align: center;
	width: 158px;
}
.eb_line_name {
	background-color:#FFFBF0;
	text-align: center;
	font-weight: bold;
	width: 150px;
}
</style>

</head>
<script src="/mchp.js" type="text/javascript"></script>

<body onLoad="butLoadFromDeviceOnClick()">

<script language="javascript">
if (readCookie("sid") == '') window.location = 'login.html';
</script>

<a href="\">
<img src="logo.png"  width="185" height="45">
</a>
<h3>Настройка устройства R 6 LME 02</h3>
<p>
<a href="/login.html" onClick="logOff()">Выход</a><a>&nbsp;&nbsp;&nbsp;</a><a href="netsettings.html">Сетевые настройки</a>
<a>&nbsp;&nbsp;&nbsp;</a><a href="administration.html">Администрирование</a>
<a>&nbsp;&nbsp;&nbsp;</a><span id="conn_st" style="color:#F00">&nbsp;</span>
</p>
<form action="/mainpage.html" method="get" name="form1">
<table border="1" cellspacing="5" cellpadding="2" class="tbl">
  <tr>
    <th width="200"  scope="col">
      <div align="center">
      <input name="L1_NAME" type="text" class="eb_line_name" id="L1_NAME" value="" maxlength="31">
      </div>
    </th>
    <th width="200"  scope="col"> <div align="center">
      <input name="L2_NAME" type="text" class="eb_line_name" id="L2_NAME" value="" maxlength="31">
      </div>
    </th>
    <th width="200"  scope="col"> <div align="center">
      <input name="L3_NAME" type="text" class="eb_line_name" id="L3_NAME" value="" maxlength="31">
      </div>
    </th>
    <th width="200"  scope="col"> <div align="center">
      <input name="L4_NAME" type="text" class="eb_line_name" id="L4_NAME" value="" maxlength="31">
      </div>
    </th>
    <th width="200"  scope="col"> <div align="center">
      <input name="L5_NAME" type="text" class="eb_line_name" id="L5_NAME" value="" maxlength="31">
      </div>
    </th>
    <th width="200"  scope="col"> <div align="center">
      <input name="L6_NAME" type="text" class="eb_line_name" id="L6_NAME" value="" maxlength="31">
    </div>
    </th>
  </tr>
  <tr>
    <td><div align="center">Импеданс линии (1кГц)<br>
      <input name="L1_REF_IMP_1KHz" type="text" disabled class="eb_RO" id="L1_REF_IMP_1KHz" value="-" readonly>
    </div>
	</td>
    <td><div align="center">Импеданс линии (1кГц)<br>
      <input name="L2_REF_IMP_1KHz" type="text" disabled class="eb_RO" id="L2_REF_IMP_1KHz" value="-" readonly>
    </div></td>
    <td><div align="center">Импеданс линии (1кГц)<br>
      <input name="L3_REF_IMP_1KHz" type="text" disabled class="eb_RO" id="L3_REF_IMP_1KHz" value="-" readonly>
    </div></td>
    <td><div align="center">Импеданс линии (1кГц)<br>
      <input name="L4_REF_IMP_1KHz" type="text" disabled class="eb_RO" id="L4_REF_IMP_1KHz" value="-" readonly>
    </div></td>
    <td><div align="center">Импеданс линии (1кГц)<br>
      <input name="L5_REF_IMP_1KHz" type="text" disabled class="eb_RO" id="L5_REF_IMP_1KHz" value="-" readonly>
    </div></td>
    <td><div align="center">Импеданс линии (1кГц)<br>
      <input name="L6_REF_IMP_1KHz" type="text" disabled class="eb_RO" id="L6_REF_IMP_1KHz" value="-" readonly>
    </div></td>
  </tr>
  <tr>
    <td align="center">Опор. импеданс (80Гц)<br>
      <input name="L1_REF_IMP_80Hz" type="text" disabled class="eb_RO" id="L1_REF_IMP_80Hz" value="-" readonly></td>
    <td align="center">Опор. импеданс (80Гц)<br>
      <input name="L2_REF_IMP_80Hz" type="text" disabled class="eb_RO" id="L2_REF_IMP_80Hz" value="-" readonly></td>
    <td align="center">Опор. импеданс (80Гц)<br>
      <input name="L3_REF_IMP_80Hz" type="text" disabled class="eb_RO" id="L3_REF_IMP_80Hz" value="-" readonly></td>
    <td align="center">Опор. импеданс (80Гц)<br>
      <input name="L4_REF_IMP_80Hz" type="text" disabled class="eb_RO" id="L4_REF_IMP_80Hz" value="-" readonly></td>
    <td align="center">Опор. импеданс (80Гц)<br>
      <input name="L5_REF_IMP_80Hz" type="text" disabled class="eb_RO" id="L5_REF_IMP_80Hz" value="-" readonly></td>
    <td align="center">Опор. импеданс (80Гц)<br>
      <input name="L6_REF_IMP_80Hz" type="text" disabled class="eb_RO" id="L6_REF_IMP_80Hz" value="-" readonly></td>
  </tr>
  <tr>
    <td align="center">Посл. измерение (80Гц)<br>
      <input name="L1_LAST_MEAS" type="text" disabled class="eb_RO" id="L1_LAST_MEAS" value="-" readonly></td>
    <td align="center">Посл. измерение (80Гц)<br>
      <input name="L2_LAST_MEAS" type="text" disabled class="eb_RO" id="L2_LAST_MEAS" value="-" readonly></td>
    <td align="center">Посл. измерение (80Гц)<br>
      <input name="L3_LAST_MEAS" type="text" disabled class="eb_RO" id="L3_LAST_MEAS" value="-" readonly></td>
    <td align="center">Посл. измерение (80Гц)<br>
      <input name="L4_LAST_MEAS" type="text" disabled class="eb_RO" id="L4_LAST_MEAS" value="-" readonly></td>
    <td align="center">Посл. измерение (80Гц)<br>
      <input name="L5_LAST_MEAS" type="text" disabled class="eb_RO" id="L5_LAST_MEAS" value="-" readonly></td>
    <td align="center">Посл. измерение (80Гц)<br>
      <input name="L6_LAST_MEAS" type="text" disabled class="eb_RO" id="L6_LAST_MEAS" value="-" readonly></td>
  </tr>
  <tr>
    <td align="center">Ошибка калибровки<br>
      <input name="L1_CAL_ERR" type="text" disabled class="eb_RO" id="L1_CAL_ERR" value="-" readonly></td>
    <td align="center">Ошибка калибровки<br>
      <input name="L2_CAL_ERR" type="text" disabled class="eb_RO" id="L2_CAL_ERR" value="-" readonly></td>
    <td align="center">Ошибка калибровки<br>
      <input name="L3_CAL_ERR" type="text" disabled class="eb_RO" id="L3_CAL_ERR" value="-" readonly></td>
    <td align="center">Ошибка калибровки<br>
      <input name="L4_CAL_ERR" type="text" disabled class="eb_RO" id="L4_CAL_ERR" value="-" readonly></td>
    <td align="center">Ошибка калибровки<br>
      <input name="L5_CAL_ERR" type="text" disabled class="eb_RO" id="L5_CAL_ERR" value="-" readonly></td>
    <td align="center">Ошибка калибровки<br>
      <input name="L6_CAL_ERR" type="text" disabled class="eb_RO" id="L6_CAL_ERR" value="-" readonly></td>
  </tr>
  <tr>
    <td align="center">Ошибка импеданса<br>
      <input name="L1_IMP_ERR" type="text" disabled class="eb_RO" id="L1_IMP_ERR" value="-" readonly></td>
    <td align="center">Ошибка импеданса<br>
      <input name="L2_IMP_ERR" type="text" disabled class="eb_RO" id="L2_IMP_ERR" value="-" readonly></td>
    <td align="center">Ошибка импеданса<br>
      <input name="L3_IMP_ERR" type="text" disabled class="eb_RO" id="L3_IMP_ERR" value="-" readonly></td>
    <td align="center">Ошибка импеданса<br>
      <input name="L4_IMP_ERR" type="text" disabled class="eb_RO" id="L4_IMP_ERR" value="-" readonly></td>
    <td align="center">Ошибка импеданса<br>
      <input name="L5_IMP_ERR" type="text" disabled class="eb_RO" id="L5_IMP_ERR" value="-" readonly></td>
    <td align="center">Ошибка импеданса<br>
      <input name="L6_IMP_ERR" type="text" disabled class="eb_RO" id="L6_IMP_ERR" value="-" readonly></td>
  </tr>
  <tr>
    <td align="center">Ошибка: утечка на землю<br>
      <input name="L1_GND_ERR" type="text" disabled class="eb_RO" id="L1_GND_ERR" value="-" readonly></td>
    <td align="center">Ошибка: утечка на землю<br>
      <input name="L2_GND_ERR" type="text" disabled class="eb_RO" id="L2_GND_ERR" value="-" readonly></td>
    <td align="center">Ошибка: утечка на землю<br>
      <input name="L3_GND_ERR" type="text" disabled class="eb_RO" id="L3_GND_ERR" value="-" readonly></td>
    <td align="center">Ошибка: утечка на землю<br>
      <input name="L4_GND_ERR" type="text" disabled class="eb_RO" id="L4_GND_ERR" value="-" readonly></td>
    <td align="center">Ошибка: утечка на землю<br>
      <input name="L5_GND_ERR" type="text" disabled class="eb_RO" id="L5_GND_ERR" value="-" readonly></td>
    <td align="center">Ошибка: утечка на землю<br>
      <input name="L6_GND_ERR" type="text" disabled class="eb_RO" id="L6_GND_ERR" value="-" readonly></td>
  </tr>
  <tr>
    <td align="center">Ошибка: КЗ линии<br>
      <input name="L1_SHT_ERR" type="text" disabled class="eb_RO" id="L1_SHT_ERR" value="-" readonly></td>
    <td align="center">Ошибка: КЗ линии<br>
      <input name="L2_SHT_ERR" type="text" disabled class="eb_RO" id="L2_SHT_ERR" value="-" readonly></td>
    <td align="center">Ошибка: КЗ линии<br>
      <input name="L3_SHT_ERR" type="text" disabled class="eb_RO" id="L3_SHT_ERR" value="-" readonly></td>
    <td align="center">Ошибка: КЗ линии<br>
      <input name="L4_SHT_ERR" type="text" disabled class="eb_RO" id="L4_SHT_ERR" value="-" readonly></td>
    <td align="center">Ошибка: КЗ линии<br>
      <input name="L5_SHT_ERR" type="text" disabled class="eb_RO" id="L5_SHT_ERR" value="-" readonly></td>
    <td align="center">Ошибка: КЗ линии<br>
      <input name="L5_SHT_ERR" type="text" disabled class="eb_RO" id="L6_SHT_ERR" value="-" readonly></td>
  </tr>
  <tr>
    <td align="center">Мониторинг включен<br>
      <input name="L1_LINE_EN" type="text" disabled class="eb_RO" id="L1_LINE_EN" value="-" readonly></td>
    <td align="center">Мониторинг включен<br>
      <input name="L2_LINE_EN" type="text" disabled class="eb_RO" id="L2_LINE_EN" value="-" readonly></td>
    <td align="center">Мониторинг включен<br>
      <input name="L3_LINE_EN" type="text" disabled class="eb_RO" id="L3_LINE_EN" value="-" readonly></td>
    <td align="center">Мониторинг включен<br>
      <input name="L4_LINE_EN" type="text" disabled class="eb_RO" id="L4_LINE_EN" value="-" readonly></td>
    <td align="center">Мониторинг включен<br>
      <input name="L5_LINE_EN" type="text" disabled class="eb_RO" id="L5_LINE_EN" value="-" readonly></td>
    <td align="center">Мониторинг включен<br>
      <input name="L6_LINE_EN" type="text" disabled class="eb_RO" id="L6_LINE_EN" value="-" readonly></td>
  </tr>
  <tr>
    <td align="center">Текущее отклонение, %<br>
      <input name="L1_DISCREPANCY" type="text" disabled class="eb_RO" id="L1_DISCREPANCY" value="-" readonly></td>
    <td align="center">Текущее отклонение, %<br>
      <input name="L2_DISCREPANCY" type="text" disabled class="eb_RO" id="L2_DISCREPANCY" value="-" readonly></td>
    <td align="center">Текущее отклонение, %<br>
      <input name="L3_DISCREPANCY" type="text" disabled class="eb_RO" id="L3_DISCREPANCY" value="-" readonly></td>
    <td align="center">Текущее отклонение, %<br>
      <input name="L4_DISCREPANCY" type="text" disabled class="eb_RO" id="L4_DISCREPANCY" value="-" readonly></td>
    <td align="center">Текущее отклонение, %<br>
      <input name="L5_DISCREPANCY" type="text" disabled class="eb_RO" id="L5_DISCREPANCY" value="-" readonly></td>
    <td align="center">Текущее отклонение, %<br>
      <input name="L6_DISCREPANCY" type="text" disabled class="eb_RO" id="L6_DISCREPANCY" value="-" readonly></td>
  </tr>
  <tr>
    <td align="center">Верхний порог, %<br>
      <input name="L1_TOP_LIMIT" type="text" id="L1_TOP_LIMIT" value="-" class="eb_RO" readonly></td>
    <td align="center">Верхний порог, %<br>
      <input name="L2_TOP_LIMIT" type="text" id="L2_TOP_LIMIT" value="-" class="eb_RO" readonly></td>
    <td align="center">Верхний порог, %<br>
      <input name="L3_TOP_LIMIT" type="text" id="L3_TOP_LIMIT" value="-" class="eb_RO" readonly></td>
    <td align="center">Верхний порог, %<br>
      <input name="L4_TOP_LIMIT" type="text" id="L4_TOP_LIMIT" value="-" class="eb_RO" readonly></td>
    <td align="center">Верхний порог, %<br>
      <input name="L5_TOP_LIMIT" type="text" id="L5_TOP_LIMIT" value="-" class="eb_RO" readonly></td>
    <td align="center">Верхний порог, %<br>
      <input name="L6_TOP_LIMIT" type="text" id="L6_TOP_LIMIT" value="-" class="eb_RO" readonly></td>
  </tr>
  <tr>
    <td align="center">Нижний порог, %<br>
      <input name="L1_BOT_LIMIT" type="text" disabled class="eb_RO" id="L1_BOT_LIMIT" value="-" readonly></td>
    <td align="center">Нижний порог, %<br>
      <input name="L2_BOT_LIMIT" type="text" disabled class="eb_RO" id="L2_BOT_LIMIT" value="-" readonly></td>
    <td align="center">Нижний порог, %<br>
      <input name="L3_BOT_LIMIT" type="text" disabled class="eb_RO" id="L3_BOT_LIMIT" value="-" readonly></td>
    <td align="center">Нижний порог, %<br>
      <input name="L4_BOT_LIMIT" type="text" disabled class="eb_RO" id="L4_BOT_LIMIT" value="-" readonly></td>
    <td align="center">Нижний порог, %<br>
      <input name="L5_BOT_LIMIT" type="text" disabled class="eb_RO" id="L5_BOT_LIMIT" value="-" readonly></td>
    <td align="center">Нижний порог, %<br>
      <input name="L6_BOT_LIMIT" type="text" disabled class="eb_RO" id="L6_BOT_LIMIT" value="-" readonly></td>
  </tr>
  <tr>
    <td align="center">Счётчик ошибок<br>
      <input name="L1_ERR_COUNTER" type="text" disabled class="eb_RO" id="L1_ERR_COUNTER" value="-" readonly></td>
    <td align="center">Счётчик ошибок<br>
      <input name="L2_ERR_COUNTER" type="text" disabled class="eb_RO" id="L2_ERR_COUNTER" value="-" readonly></td>
    <td align="center">Счётчик ошибок<br>
      <input name="L3_ERR_COUNTER" type="text" disabled class="eb_RO" id="L3_ERR_COUNTER" value="-" readonly></td>
    <td align="center">Счётчик ошибок<br>
      <input name="L4_ERR_COUNTER" type="text" disabled class="eb_RO" id="L4_ERR_COUNTER" value="-" readonly></td>
    <td align="center">Счётчик ошибок<br>
      <input name="L5_ERR_COUNTER" type="text" disabled class="eb_RO" id="L5_ERR_COUNTER" value="-" readonly></td>
    <td align="center">Счётчик ошибок<br>
      <input name="L6_ERR_COUNTER" type="text" disabled class="eb_RO" id="L6_ERR_COUNTER" value="-" readonly></td>
  </tr>
  <tr>
    <td colspan="6" style="text-align:center">Настройки</td>
  </tr>
  <tr>
        <td align="center">Мониторинг вкл.
          <input name="L1_LINE_EN" type="checkbox" id="L1_LINE_EN_CB"></td>
        <td align="center">Мониторинг вкл.
          <input name="L2_LINE_EN" type="checkbox" id="L2_LINE_EN_CB"></td>
        <td align="center">Мониторинг вкл.
          <input name="L3_LINE_EN" type="checkbox" id="L3_LINE_EN_CB"></td>
        <td align="center">Мониторинг вкл.
          <input name="L4_LINE_EN" type="checkbox" id="L4_LINE_EN_CB"></td>
        <td align="center">Мониторинг вкл.
          <input name="L5_LINE_EN" type="checkbox" id="L5_LINE_EN_CB"></td>
        <td align="center">Мониторинг вкл.
          <input name="L6_LINE_EN" type="checkbox" id="L6_LINE_EN_CB"></td>
  </tr>
  <tr>
<td align="center">Верхний порог, %<br>
<select name="L1_TOP_LIMIT" class="eb_RW" id="L1_TOP_LIMIT_LISTBOX">
  <option value="5">+5</option>
  <option value="10">+10</option>
  <option value="20">+20</option>
  <option value="30">+30</option>
  <option value="40">+40</option>
  <option value="50">+50</option>
</select></td>
<td align="center">Верхний порог, %<br>
  <select name="L2_TOP_LIMIT" class="eb_RW" id="L2_TOP_LIMIT_LISTBOX">
  <option value="5">+5</option>
  <option value="10">+10</option>
  <option value="20">+20</option>
  <option value="30">+30</option>
  <option value="40">+40</option>
  <option value="50">+50</option>
  </select></td>
<td align="center">Верхний порог, %<br>
  <select name="L3_TOP_LIMIT" class="eb_RW" id="L3_TOP_LIMIT_LISTBOX">
  <option value="5">+5</option>
  <option value="10">+10</option>
  <option value="20">+20</option>
  <option value="30">+30</option>
  <option value="40">+40</option>
  <option value="50">+50</option>
  </select></td>
<td align="center">Верхний порог, %<br>
  <select name="L4_TOP_LIMIT" class="eb_RW" id="L4_TOP_LIMIT_LISTBOX">
  <option value="5">+5</option>
  <option value="10">+10</option>
  <option value="20">+20</option>
  <option value="30">+30</option>
  <option value="40">+40</option>
  <option value="50">+50</option>
  </select></td>
<td align="center">Верхний порог, %<br>
  <select name="L5_TOP_LIMIT" class="eb_RW" id="L5_TOP_LIMIT_LISTBOX">
  <option value="5">+5</option>
  <option value="10">+10</option>
  <option value="20">+20</option>
  <option value="30">+30</option>
  <option value="40">+40</option>
  <option value="50">+50</option>
  </select></td>
<td align="center">Верхний порог, %<br>
  <select name="L6_TOP_LIMIT" class="eb_RW" id="L6_TOP_LIMIT_LISTBOX">
  <option value="5">+5</option>
  <option value="10">+10</option>
  <option value="20">+20</option>
  <option value="30">+30</option>
  <option value="40">+40</option>
  <option value="50">+50</option>
  </select></td>
  </tr>
  <tr>
<td align="center">Нижний порог, %<br>
<select name="L1_BOT_LIMIT" class="eb_RW" id="L1_BOT_LIMIT_LISTBOX">
  <option value="-5">-5</option>
  <option value="-10">-10</option>
  <option value="-20">-20</option>
  <option value="-30">-30</option>
  <option value="-40">-40</option>
  <option value="-50">-50</option>
</select></td>
<td align="center">Нижний порог, %<br>
  <select name="L2_BOT_LIMIT" class="eb_RW" id="L2_BOT_LIMIT_LISTBOX">
  <option value="-5">-5</option>
  <option value="-10">-10</option>
  <option value="-20">-20</option>
  <option value="-30">-30</option>
  <option value="-40">-40</option>
  <option value="-50">-50</option>
  </select></td>
<td align="center">Нижний порог, %<br>
  <select name="L3_BOT_LIMIT" class="eb_RW" id="L3_BOT_LIMIT_LISTBOX">
  <option value="-5">-5</option>
  <option value="-10">-10</option>
  <option value="-20">-20</option>
  <option value="-30">-30</option>
  <option value="-40">-40</option>
  <option value="-50">-50</option>
  </select></td>
<td align="center">Нижний порог, %<br>
  <select name="L4_BOT_LIMIT" class="eb_RW" id="L4_BOT_LIMIT_LISTBOX">
  <option value="-5">-5</option>
  <option value="-10">-10</option>
  <option value="-20">-20</option>
  <option value="-30">-30</option>
  <option value="-40">-40</option>
  <option value="-50">-50</option>
  </select></td>
<td align="center">Нижний порог, %<br>
  <select name="L5_BOT_LIMIT" class="eb_RW" id="L5_BOT_LIMIT_LISTBOX">
  <option value="-5">-5</option>
  <option value="-10">-10</option>
  <option value="-20">-20</option>
  <option value="-30">-30</option>
  <option value="-40">-40</option>
  <option value="-50">-50</option>
  </select></td>
<td align="center">Нижний порог, %<br>
  <select name="L6_BOT_LIMIT" class="eb_RW" id="L6_BOT_LIMIT_LISTBOX">
  <option value="-5">-5</option>
  <option value="-10">-10</option>
  <option value="-20">-20</option>
  <option value="-30">-30</option>
  <option value="-40">-40</option>
  <option value="-50">-50</option>
  </select></td>
  </tr>
  <tr>
    <td align="center"><input type="button" name="butL1StartCalibration" id="butL1StartCalibration" value="Запустить калибровку" onClick="butStartCalibrationOnClick(this.id)" style="width:150px"></td>
    <td align="center"><input type="button" name="butL2StartCalibration" id="butL2StartCalibration" value="Запустить калибровку" onClick="butStartCalibrationOnClick(this.id)" style="width:150px"></td>
    <td align="center"><input type="button" name="butL3StartCalibration" id="butL3StartCalibration" value="Запустить калибровку" onClick="butStartCalibrationOnClick(this.id)" style="width:150px"></td>
    <td align="center"><input type="button" name="butL4StartCalibration" id="butL4StartCalibration" value="Запустить калибровку" onClick="butStartCalibrationOnClick(this.id)" style="width:150px"></td>
    <td align="center"><input type="button" name="butL5StartCalibration" id="butL5StartCalibration" value="Запустить калибровку" onClick="butStartCalibrationOnClick(this.id)" style="width:150px"></td>
    <td align="center"><input type="button" name="butL6StartCalibration" id="butL6StartCalibration" value="Запустить калибровку" onClick="butStartCalibrationOnClick(this.id)" style="width:150px"></td>
  </tr>
  <tr>
    <td align="center"><input type="button" name="butL1StartMeasurement" id="butL1StartMeasurement" value="Запустить измерение" onClick="butStartMeasurementOnClick(this.id)" style="width:150px"></td>
    <td align="center"><input type="button" name="butL2StartMeasurement" id="butL2StartMeasurement" value="Запустить измерение" onClick="butStartMeasurementOnClick(this.id)" style="width:150px"></td>
    <td align="center"><input type="button" name="butL3StartMeasurement" id="butL3StartMeasurement" value="Запустить измерение" onClick="butStartMeasurementOnClick(this.id)" style="width:150px"></td>
    <td align="center"><input type="button" name="butL4StartMeasurement" id="butL4StartMeasurement" value="Запустить измерение" onClick="butStartMeasurementOnClick(this.id)" style="width:150px"></td>
    <td align="center"><input type="button" name="butL5StartMeasurement" id="butL5StartMeasurement" value="Запустить измерение" onClick="butStartMeasurementOnClick(this.id)" style="width:150px"></td>
    <td align="center"><input type="button" name="butL6StartMeasurement" id="butL6StartMeasurement" value="Запустить измерение" onClick="butStartMeasurementOnClick(this.id)" style="width:150px"></td>
  </tr>
</table>

<p><table width="463" border="0" cellspacing="5" cellpadding="2">
  <tr>
    <td width="270">Установка интервала измерения</td>
    <td width="170" align="right"><select name="MEAS_INTERVAL" class="lb_RW" id="MEAS_INTERVAL_LISTBOX" style="width:260; text-align:left">
      <option value="60">1 мин.</option>
      <option value="600">10 мин.</option>
      <option value="3600">1 ч.</option>
      <option value="21600">6 ч.</option>
      <option value="43200">12 ч.</option>
    </select></td>
  </tr>
  <tr>
    <td>Текущий интервал измерения</td>
    <td align="right">
      <input name="MEAS_INTERVAL" type="text" disabled class="eb_RO" id="MEAS_INTERVAL" value="-" readonly style="width:260; text-align:left">
    </td>
  </tr>
  </table>
<p>
  <input type="button" name="butLoadFromDevice" id="butLoadFromDevice" value="Загрузить данные из устройства" onClick="butLoadFromDeviceOnClick()" style="width:240px">
  <input type="button" name="butSaveToDevice" id="butSaveToDevice" value="Сохранить настройки в устройство" onClick="butSaveToDeviceOnClick()" style="width:260px">
</p>
</form>

<script type="text/javascript">
<!--

// Parses the xmlResponse from status.xml and updates the status box
function updateStatus(xmlData) {
// Check if a timeout occurred
	if(!xmlData)
	{
		document.getElementById('conn_st').innerHTML = "Нет соединения! Проверьте подключение.";
		document.getElementById('conn_st').style.color = '#F00';
		//alert("Соединение потеряно!\nПроверьте подключение.");
		return;
	} else {
		document.getElementById('conn_st').innerHTML = "Соединение установлено!";
		document.getElementById('conn_st').style.color = '#557F00';
	}
}
function parseStatusXML(xmlData) {
	var i, el, chbox, lbox, index;
	var xml_value;
	for(i = 1; i <= NUM_LINES; i++) { 
		document.getElementById('L'+i+'_NAME').value = getXMLValue(xmlData, 'line_name'+i);
		document.getElementById('L'+i+'_REF_IMP_1KHz').value = getXMLValue(xmlData, 'ref_imp_1khz'+i);
		document.getElementById('L'+i+'_REF_IMP_80Hz').value = getXMLValue(xmlData, 'ref_imp_80hz'+i);
		if (parseFloat(getXMLValue(xmlData, 'last_meas'+i)) < 0) document.getElementById('L'+i+'_LAST_MEAS').value = '-';
		else document.getElementById('L'+i+'_LAST_MEAS').value = getXMLValue(xmlData, 'last_meas'+i);
		
		el = document.getElementById('L'+i+'_CAL_ERR');
		xml_value = getXMLValue(xmlData, 'cal_err'+i);
		if (xml_value == '1') {
			el.value = "да";
			el.style.color = '#F00';
			el.style.fontWeight = "bold";
		} else if (xml_value == '0') {
			el.value = "нет";
			el.style.color = '#557F00';
			el.style.fontWeight = "normal";
		} else {
			el.value = "-";
			el.style.color = '#000000';
			el.style.fontWeight = "normal";
		}
		el = document.getElementById('L'+i+'_IMP_ERR');
		xml_value = getXMLValue(xmlData, 'imp_err'+i);
		if (xml_value == '1') {
			el.value = "да";
			el.style.color = '#F00';
			el.style.fontWeight = "bold";
		} else if (xml_value == '0') {
			el.value = "нет";
			el.style.color = '#557F00';
			el.style.fontWeight = "normal";
		} else {
			el.value = "-";
			el.style.color = '#000000';
			el.style.fontWeight = "normal";
		}
		el = document.getElementById('L'+i+'_GND_ERR');
		xml_value = getXMLValue(xmlData, 'gnd_err'+i);
		if (xml_value == '1') {
			el.value = "да";
			el.style.color = '#F00';
			el.style.fontWeight = "bold";
		} else if (xml_value == '0') {
			el.value = "нет";
			el.style.color = '#557F00';
			el.style.fontWeight = "normal";
		} else {
			el.value = "-";
			el.style.color = '#000000';
			el.style.fontWeight = "normal";
		}
		el = document.getElementById('L'+i+'_SHT_ERR');
		xml_value = getXMLValue(xmlData, 'sht_err'+i);
		if (xml_value == '1') {
			el.value = "да";
			el.style.color = '#F00';
			el.style.fontWeight = "bold";
		} else if (xml_value == '0') {
			el.value = "нет";
			el.style.color = '#557F00';
			el.style.fontWeight = "normal";
		} else {
			el.value = "-";
			el.style.color = '#000000';
			el.style.fontWeight = "normal";
		}
		el = document.getElementById('L'+i+'_LINE_EN');
		chbox = document.getElementById('L'+i+'_LINE_EN_CB');
		if (getXMLValue(xmlData, 'line_enabled'+i) == '1') {
			el.value = "да";
			chbox.checked = true;
			el.style.fontWeight = "bold";
		} else {
			el.value = "нет";
			chbox.checked = false;
			el.style.fontWeight = "normal";
		}
		document.getElementById('L'+i+'_DISCREPANCY').value = getXMLValue(xmlData, 'discrepancy'+i);
		document.getElementById('L'+i+'_TOP_LIMIT').value = getXMLValue(xmlData, 'top_limit'+i);
		document.getElementById('L'+i+'_TOP_LIMIT_LISTBOX').value = getXMLValue(xmlData, 'top_limit'+i);
		document.getElementById('L'+i+'_BOT_LIMIT').value = getXMLValue(xmlData, 'bot_limit'+i);
		document.getElementById('L'+i+'_BOT_LIMIT_LISTBOX').value = getXMLValue(xmlData, 'bot_limit'+i);
		document.getElementById('L'+i+'_ERR_COUNTER').value = getXMLValue(xmlData, 'err_counter'+i);
	}
	document.getElementById('MEAS_INTERVAL_LISTBOX').value = getXMLValue(xmlData, 'meas_interval');
	lbox = document.getElementById('MEAS_INTERVAL_LISTBOX');
	index = lbox.selectedIndex;
	document.getElementById('MEAS_INTERVAL').value = lbox.options[index].text;
}
function loadFromDevice(xmlData) {
// Check if a timeout occurred
	if(!xmlData)
	{
		alert("Ошибка! Устройство LME не отвечает.\nПроверьте подключение.");
		return;
	} else {		
		parseStatusXML(xmlData); // заполняем все поля страницы данными из XML
		
		if (verbose == true) {
			document.getElementById('result').innerHTML = "Успешно прочитано!";
			setTimeout("hideResult()", 3000);		
		}
	}
}
function saveToDevice(xmlData) { // обработчик ответа на сохранение
// Check if a timeout occurred
	if(!xmlData)
	{
		alert("Ошибка! Устройство LME не отвечает.\nПроверьте подключение.");
		return;
	} else {
		if (getXMLValue(xmlData, 'result') == "OK") {
			document.getElementById('result').innerHTML = "Успешно записано!";
			verbose = false;
			newAJAXCommand('status.xml', loadFromDevice, false);
		} else if (getXMLValue(xmlData, 'result') == "ERR") {
			alert("Ошибка! Устройство ответило, но запись окончилась неудачей.");
		} else {
			alert("Неверный формат XML!");
		}
		
		setTimeout("hideResult()", 3000);
	}
}

function startMeasHandler(xmlData) {
// Check if a timeout occurred
	if(!xmlData)
	{
		alert("Ошибка! Устройство LME не отвечает.\nПроверьте подключение.");
		return;
	} else {
		if (getXMLValue(xmlData, 'result') == "OK") {
			document.getElementById('result').innerHTML = "Измерение успешно завершено!";
			verbose = false;
			newAJAXCommand('status.xml', loadFromDevice, false);
		} else if (getXMLValue(xmlData, 'result') == "ERR") {
			alert("Ошибка! Измерение окончилось неудачей.");
		} else {
			alert("Неверный формат XML!");
		}
		
		setTimeout("hideResult()", 3000);
	}
}

function startCalHandler(xmlData) {
// Check if a timeout occurred
	if(!xmlData)
	{
		alert("Ошибка! Устройство LME не отвечает.\nПроверьте подключение.");
		return;
	} else {
		if (getXMLValue(xmlData, 'result') == "OK") {
			document.getElementById('result').innerHTML = "Калибровка успешно завершена!";
			verbose = false;
			newAJAXCommand('status.xml', loadFromDevice, false);
		} else if (getXMLValue(xmlData, 'result') == "ERR") {
			alert("Ошибка! Калибровка окончилась неудачей.");
		} else {
			alert("Неверный формат XML!");
		}
		
		setTimeout("hideResult()", 3000);
	}
}

// обработчики нажатий кнопок
function butLoadFromDeviceOnClick() {
	verbose = true;
	newAJAXCommand('status.xml', loadFromDevice, false);
}

function butSaveToDeviceOnClick() {
	var i;
	
	str = "save_parameters\n";
	
	for(i = 1; i < 7; i++) {
		addToStrNameAndValue("L" + i + "_NAME");
	}
	for(i = 1; i < 7; i++) {
		addToStrNameAndValue("L" + i + "_LINE_EN_CB");
	}
	for(i = 1; i < 7; i++) {
		addToStrNameAndValue("L" + i + "_TOP_LIMIT_LISTBOX");
	}
	for(i = 1; i < 7; i++) {
		addToStrNameAndValue("L" + i + "_BOT_LIMIT_LISTBOX");
	}
	
	addToStrNameAndValue("MEAS_INTERVAL_LISTBOX");
	str += "\0";
	
	newAJAXCommand('save.xml', saveToDevice, false, str);
}

function butStartCalibrationOnClick(clicked_id) {
	newAJAXCommand('start_cal.xml'+'?line='+(clicked_id[4]-1), startCalHandler, false);
}

function butStartMeasurementOnClick(clicked_id) {
	newAJAXCommand('start_meas.xml'+'?line='+(clicked_id[4]-1), startMeasHandler, false);
}


// осн. тело
//setTimeout("newAJAXCommand('status.xml', updateStatus, true)",2000);
//setTimeout("newAJAXCommand('status.xml', updateStatus, false)",5000); // TODO: временно не повторяем

//-->
</script>


<div id="result">&nbsp;</div>

</body>
</html>
